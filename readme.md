è¿™æ˜¯ä¸€ä¸ªå…¨é¢æ›´æ–°åçš„ Postman æ¥å£æµ‹è¯•æŒ‡å—ï¼Œæ¶µç›–äº†ä½ æ‰€æœ‰çš„æ ¸å¿ƒåŠŸèƒ½ï¼ŒåŒ…æ‹¬æœ€æ–°çš„ **â€œæˆ‘çš„å‘é€åˆ—è¡¨â€ (Sent List)** å’Œ **â€œåŸºäºåˆ—è¡¨æŸ¥çœ‹è¯¦æƒ…â€** çš„é€»è¾‘ã€‚

ä¸ºäº†è®©æµ‹è¯•æµç¨‹æ›´æµç•…ï¼Œæˆ‘å°†å…¶åˆ’åˆ†ä¸ºå‡ ä¸ªé€»è¾‘ä¸¥å¯†çš„é˜¶æ®µï¼š

1. **å‡†å¤‡å·¥ä½œ** (User A æ³¨å†Œ/å‘æ–‡)
2. **åˆ†äº«æ“ä½œ** (User A åˆ†äº«/ç®¡ç†)
3. **æ¥æ”¶ä½“éªŒ** (User B æŸ¥çœ‹)
4. **å…¬å¼€é“¾æ¥** (åŒ¿åè®¿é—®)
5. **æ’¤é”€é—­ç¯** (User A æ’¤é”€ -> User B å¤±æ•ˆ)

---

# ğŸ§ª ä¸å¯ç¯¡æ”¹æ–‡æœ¬å­˜è¯å¹³å° - Postman æ¥å£æµ‹è¯•æŒ‡å— v2.0

æœ¬æ–‡æ¡£ç”¨äºæŒ‡å¯¼å¦‚ä½•ä½¿ç”¨ Postman å¯¹å¹³å°çš„å…¨ç”Ÿå‘½å‘¨æœŸåŠŸèƒ½è¿›è¡Œæµ‹è¯•ï¼Œæ¶µç›– **æ³¨å†Œç™»å½•ã€å­˜è¯ä¸Šé“¾ã€ç‚¹å¯¹ç‚¹åˆ†äº«ã€é“¾æ¥åˆ†äº«ã€åˆ†äº«åˆ—è¡¨ç®¡ç†åŠæ’¤é”€æœºåˆ¶**ã€‚

## ğŸ› ï¸ 0. å‰ç½®å‡†å¤‡

* **æœåŠ¡å™¨åœ°å€**: `http://localhost:8080`
* **Body ç±»å‹**: æ‰€æœ‰ POST è¯·æ±‚è¯·é€‰æ‹© **`Body`** -> **`raw`** -> **`JSON`**ã€‚
* **å‚æ•°ç±»å‹**: æ ‡æ³¨ä¸º **Query Params** çš„è¯·åœ¨ Postman çš„ **Params** æ å¡«å†™ï¼›æ ‡æ³¨ä¸º **JSON Body** çš„è¯·åœ¨ **Body** æ å¡«å†™ã€‚
* **Cookie ç®¡ç†**:
* Postman ä¼šè‡ªåŠ¨ç®¡ç† `JSESSIONID`ã€‚
* **âš ï¸ å…³é”®**: åˆ‡æ¢ç”¨æˆ·ï¼ˆå¦‚ä» User A æ¢åˆ° User Bï¼‰å‰ï¼Œå¿…é¡»è°ƒç”¨ **ç™»å‡ºæ¥å£** æˆ–æ‰‹åŠ¨æ¸…é™¤ Cookiesã€‚



---

## ğŸŸ¢ ç¬¬ä¸€é˜¶æ®µï¼šUser A - è´¦æˆ·ä¸å­˜è¯ (ç”Ÿäº§è€…)

### 1. å‘é€æ³¨å†ŒéªŒè¯ç 

* **åŠŸèƒ½**: è·å–é‚®ç®±éªŒè¯ç ã€‚
* **Method**: `POST`
* **URL**: `http://localhost:8080/api/auth/code`
* **Params**: `email`: `user_a@example.com`
* **ğŸ‘€ éªŒè¯**: æŸ¥çœ‹ IDE æ§åˆ¶å°æ—¥å¿—è·å– 6 ä½éªŒè¯ç ã€‚

### 2. æ³¨å†Œ User A

* **Method**: `POST`
* **URL**: `http://localhost:8080/api/auth/register`
* **Body**:
```json
{
    "email": "user_a@example.com",
    "username": "user_a",
    "password": "password123",
    "code": "123456" 
}

```



### 3. ç™»å½• User A

* **Method**: `POST`
* **URL**: `http://localhost:8080/api/auth/login`
* **Body**:
```json
{ "account": "user_a", "password": "password123" }

```


* **âœ… çŠ¶æ€**: ç™»å½•æˆåŠŸï¼ŒSession å·²å»ºç«‹ã€‚

### 4. ä¸Šä¼ å­˜è¯ (åˆ›å»ºæ–‡æœ¬)

* **åŠŸèƒ½**: ä¸Šä¼ é‡è¦æ–‡æœ¬ï¼Œç”Ÿæˆå“ˆå¸Œã€‚
* **Method**: `POST`
* **URL**: `http://localhost:8080/api/proof/upload`
* **Body**:
```json
{
    "subject": "User A çš„ç»å¯†åˆåŒ",
    "content": "è¿™æ˜¯ä¸å¯ç¯¡æ”¹çš„åˆåŒåŸå§‹å†…å®¹ï¼ŒHashå€¼å°†ç”±ç³»ç»Ÿç”Ÿæˆã€‚"
}

```


* **ğŸ“ è®°å½•**: è®°ä¸‹å“åº”ä¸­çš„ **`"id": 1`** (Proof ID)ã€‚

![ä¸Šä¼ å­˜è¯ (åˆ›å»ºæ–‡æœ¬)](./images/4. ä¸Šä¼ å­˜è¯ (åˆ›å»ºæ–‡æœ¬).png)
---

## ğŸŸ¡ ç¬¬äºŒé˜¶æ®µï¼šUser A - åˆ†äº«ä¸ç®¡ç† (åˆ†å‘è€…)

> **å‰æ**: ç¡®ä¿ `user_b` è´¦å·å·²å­˜åœ¨ï¼ˆå¯å…ˆç”¨å¦ä¸€æµè§ˆå™¨æˆ–å…ˆè·‘ä¸€é User B çš„æ³¨å†Œæµç¨‹ï¼‰ã€‚

### 5. åˆ†äº«ç»™ User B (ç‚¹å¯¹ç‚¹)

* **åŠŸèƒ½**: å°† Proof ID 1 åˆ†äº«ç»™ç”¨æˆ· `user_b`ï¼Œæœ‰æ•ˆæœŸ 10 åˆ†é’Ÿã€‚
* **Method**: `POST`
* **URL**: `http://localhost:8080/api/share/to-user`
* **Body**:
```json
{
    "proofId": 1,
    "targetUsername": "user_b",
    "validMinutes": 10
}

```



### 6. ç”Ÿæˆåˆ†äº«é“¾æ¥ (å…¬å¼€)

* **åŠŸèƒ½**: ç”Ÿæˆä¸€ä¸ªå¸¦ Token çš„å…¬å¼€é“¾æ¥ã€‚
* **Method**: `POST`
* **URL**: `http://localhost:8080/api/share/create-link`
* **Body**:
```json
{
    "proofId": 1,
    "validMinutes": 60
}

```


* **ğŸ“ è®°å½•**: å¤åˆ¶å“åº”æ•°æ®ä¸­çš„ **Token** å­—ç¬¦ä¸²ã€‚

### 7. æŸ¥çœ‹â€œæˆ‘å‘å‡ºçš„åˆ†äº«â€ (Sent List) âœ¨ æ–°åŠŸèƒ½

* **åŠŸèƒ½**: User A æŸ¥çœ‹è‡ªå·±åˆ†äº«ç»™äº†è°ï¼Œç”¨äºç®¡ç†æˆ–æ’¤é”€ã€‚
* **Method**: `GET`
* **URL**: `http://localhost:8080/api/share/sent-list`
* **é¢„æœŸç»“æœ**: è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼ŒåŒ…å«åˆšæ‰åˆ†äº«ç»™ `user_b` çš„è®°å½•ã€‚
* **ğŸ“ è®°å½•**: æ‰¾åˆ°å‘ç»™ `user_b` çš„é‚£æ¡è®°å½•ï¼Œè®°ä¸‹å®ƒçš„ **`"id": 15`** (è¿™æ˜¯ Share IDï¼Œä¸æ˜¯ Proof ID)ã€‚

### 8. æ’¤é”€ç»™ User B çš„åˆ†äº« (ç®¡ç†)

* **åŠŸèƒ½**: è®© User B æ— æ³•å†æŸ¥çœ‹è¯¥å­˜è¯ã€‚
* **Method**: `POST`
* **URL**: `http://localhost:8080/api/share/revoke/user`
* **Params** (Query): `shareId`: `15` (æ­¥éª¤ 7 è·å–çš„ Share ID)
* **Body**: æ— 
* **é¢„æœŸ**: è¿”å›â€œå·²å–æ¶ˆåˆ†äº«â€ã€‚

### 9. ç™»å‡º User A

* **Method**: `POST`
* **URL**: `http://localhost:8080/api/auth/logout`

---

## ğŸ”µ ç¬¬ä¸‰é˜¶æ®µï¼šUser B - æ¥æ”¶ä¸æŸ¥çœ‹ (æ¶ˆè´¹è€…)

### 10. ç™»å½• User B

* **Method**: `POST`
* **URL**: `http://localhost:8080/api/auth/login`
* **Body**: `{ "account": "user_b", "password": "password123" }`

### 11. æŸ¥çœ‹â€œæˆ‘æ”¶åˆ°çš„åˆ†äº«â€ (Received List)

* **åŠŸèƒ½**: User B æŸ¥çœ‹è°ç»™æˆ‘åˆ†äº«äº†æ–‡ä»¶ã€‚
* **Method**: `GET`
* **URL**: `http://localhost:8080/api/share/list`
* **é¢„æœŸ**: è¿”å› User A åˆ†äº«çš„è®°å½•åˆ—è¡¨ã€‚
* *æ³¨æ„*: å³ä½¿ User A æ’¤é”€äº†ï¼Œè¿™é‡Œå¯èƒ½ä»ä¼šæ˜¾ç¤ºè®°å½•ï¼ˆè§†å‰ç«¯é€»è¾‘è€Œå®šï¼Œé€šå¸¸æ˜¾ç¤ºä¸ºç°è‰²ï¼‰ï¼Œä½†ç‚¹å‡»è¯¦æƒ…ä¼šæŠ¥é”™ã€‚



### 12. å°è¯•æŸ¥çœ‹è¯¦æƒ… (éªŒè¯æ’¤é”€)

* **åŠŸèƒ½**: ç‚¹å‡»åˆ—è¡¨é¡¹ï¼Œè·å–å®Œæ•´æ–‡æœ¬å†…å®¹ã€‚
* **Method**: `GET`
* **URL**: `http://localhost:8080/api/share/detail/1` (æ³¨æ„ï¼šè¿™é‡Œä¼  Proof ID)
* **é¢„æœŸç»“æœ**:
* å¦‚æœ **æœªæ’¤é”€**: è¿”å› `{ "proof": { "content": "..." } }`
* å¦‚æœ **å·²æ’¤é”€** (æ­¥éª¤ 8 å·²æ‰§è¡Œ): è¿”å› `400 Bad Request`ï¼Œæ¶ˆæ¯ä¸º **â€œè¯¥åˆ†äº«å·²è¢«åˆ†äº«è€…å–æ¶ˆâ€**ã€‚



---

## ğŸŸ£ ç¬¬å››é˜¶æ®µï¼šåŒ¿åç”¨æˆ· - é“¾æ¥è®¿é—®

> **è¯´æ˜**: æ­¤æ¥å£æ— éœ€ç™»å½•ï¼Œä»»ä½•æŒæœ‰ Token çš„äººå‡å¯è®¿é—®ã€‚

### 13. è®¿é—®åˆ†äº«é“¾æ¥

* **åŠŸèƒ½**: æ¨¡æ‹Ÿæ¸¸å®¢é€šè¿‡é“¾æ¥æŸ¥çœ‹ã€‚
* **Method**: `GET`
* **URL**: `http://localhost:8080/api/share/view-link`
* **Params** (Query): `token`: `(ç²˜è´´æ­¥éª¤ 6 ç”Ÿæˆçš„ Token)`
* **é¢„æœŸ**:
* æˆåŠŸï¼šè¿”å›å­˜è¯å†…å®¹ã€‚
* å¤±è´¥ï¼šè¿”å›â€œé“¾æ¥æ— æ•ˆâ€æˆ–â€œå·²è¿‡æœŸâ€ã€‚
![Uploading image.pngâ€¦]()



### 14. æ’¤é”€é“¾æ¥ (åˆ‡å› User A æ“ä½œ)

* (éœ€å…ˆç™»å½• User A)
* **Method**: `POST`
* **URL**: `http://localhost:8080/api/share/revoke/link`
* **Params**: `token`: `(åŒä¸Š)`
* **é¢„æœŸ**: å†æ¬¡è°ƒç”¨æ­¥éª¤ 13 æ—¶ï¼Œåº”æç¤ºé“¾æ¥å·²å¤±æ•ˆã€‚

---

## ğŸ“‹ å…¨æ¥å£é€ŸæŸ¥è¡¨

| åˆ†ç±» | æ¥å£å | Method | URL (Prefix: /api) | å…³é”®å‚æ•° | æƒé™ |
| --- | --- | --- | --- | --- | --- |
| **Auth** | å‘é€éªŒè¯ç  | POST | `/auth/code` | Query: `email` | å…¬å¼€ |
|  | æ³¨å†Œ | POST | `/auth/register` | Body: JSON | å…¬å¼€ |
|  | ç™»å½• | POST | `/auth/login` | Body: JSON | å…¬å¼€ |
|  | ç™»å‡º | POST | `/auth/logout` | - | User |
| **Proof** | ä¸Šä¼ å­˜è¯ | POST | `/proof/upload` | Body: `{subject, content}` | User |
|  | æˆ‘çš„å­˜è¯åˆ—è¡¨ | GET | `/proof/list` | - | User |
|  | å­˜è¯è¯¦æƒ…(æœ¬äºº) | GET | `/proof/{id}` | Path: `proofId` | User |
| **Share (å‘)** | åˆ†äº«ç»™ç”¨æˆ· | POST | `/share/to-user` | Body: `{proofId, target, time}` | User |
|  | ç”Ÿæˆé“¾æ¥ | POST | `/share/create-link` | Body: `{proofId, time}` | User |
|  | **æˆ‘çš„å‘é€åˆ—è¡¨** | **GET** | **`/share/sent-list`** | **-** | **User** |
|  | æ’¤é”€ç”¨æˆ·åˆ†äº« | POST | `/share/revoke/user` | Query: `shareId` | User |
|  | æ’¤é”€é“¾æ¥ | POST | `/share/revoke/link` | Query: `token` | User |
| **Share (æ”¶)** | **æˆ‘çš„æ¥æ”¶åˆ—è¡¨** | **GET** | **`/share/list`** | **-** | **User** |
|  | **æŸ¥çœ‹æ¥æ”¶è¯¦æƒ…** | **GET** | **`/share/detail/{proofId}`** | **Path: `proofId**` | **User** |
|  | **è®¿é—®é“¾æ¥** | **GET** | **`/share/view-link`** | **Query: `token**` | **Public** |
